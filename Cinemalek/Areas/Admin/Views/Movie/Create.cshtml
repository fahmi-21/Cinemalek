@model MovieCreateVM

<div class="row mb-3 align-items-center my-3">
    <div class="col-md-6">
        <h2 class="display-6">Add New Movie</h2>
    </div>
</div>

<form method="post" enctype="multipart/form-data">

    <!-- Movie Name -->
    <div class="mb-3">
        <label asp-for="Movie.Name" class="form-label">Movie Name</label>
        <input asp-for="Movie.Name" class="form-control" placeholder="Enter Movie name">
        <span asp-validation-for="Movie.Name" class="text-danger"></span>
    </div>

    <!-- Category -->
    <div class="mb-3">
        <label asp-for="Movie.CategoryId" class="form-label">Category</label>
        <select asp-for="Movie.CategoryId" class="form-select">
            <option value="">-- Select Category --</option>
            @foreach (var category in Model.Categories)
            {
                <option value="@category.Id">@category.Name</option>
            }
        </select>
        <span asp-validation-for="Movie.CategoryId" class="text-danger"></span>
    </div>

    <!-- Cinema -->
    <div class="mb-3">
        <label asp-for="Movie.CinemaId" class="form-label">Cinema</label>
        <select asp-for="Movie.CinemaId" class="form-select">
            <option value="">-- Select Cinema --</option>
            @foreach (var cinema in Model.Cinemas)
            {
                <option value="@cinema.Id">@cinema.Name</option>
            }
        </select>
        <span asp-validation-for="Movie.CinemaId" class="text-danger"></span>
    </div>

    <!-- Cast -->
    <div class="mb-3">
        <label for="actorsid" class="form-label">Cast</label>
        <select class="form-select" name="actorsid" multiple>
            @foreach (var actor in Model.Actors)
            {
                <option value="@actor.Id">@actor.Name</option>
            }
        </select>
    </div>

    <!-- Main Image -->
    <div class="mb-3">
        <label for="mainimg" class="form-label">Profile Img</label>
        <input class="form-control" type="file" name="MainImg" onchange="previewMainImage(event)">
        <span asp-validation-for="Movie.Img" class="text-danger"></span>
        <img id="mainPreview" style="max-width:200px; margin-top:10px; border:1px solid #ccc; border-radius:10px;" />
    </div>

    <!-- Sub Images -->
    <div class="mb-3">
        <label for="subimgs" class="form-label">Sub Imgs</label>
        <input class="form-control" type="file" name="SubImgs" multiple onchange="previewSubImages(event)">
        <div id="subPreview" class="d-flex gap-2 mt-2"></div>
    </div>

    <!-- Status -->
    <div class="mb-3">
        <label asp-for="Movie.Status" class="form-label">Status</label>
        <select asp-for="Movie.Status" class="form-select">
            <option value="true">Active</option>
            <option value="false">Not Active</option>
        </select>
        <span asp-validation-for="Movie.Status" class="text-danger"></span>
    </div>

    <!-- Price -->
    <div class="mb-3">
        <label asp-for="Movie.Price" class="form-label">Price</label>
        <input asp-for="Movie.Price" type="number" step="0.01" class="form-control" placeholder="Price ...">
        <span asp-validation-for="Movie.Price" class="text-danger"></span>
    </div>

    <!-- Date -->
    <div class="mb-3">
        <label asp-for="Movie.Date" class="form-label">Date</label>
        <input asp-for="Movie.Date" type="datetime-local" class="form-control">
        <span asp-validation-for="Movie.Date" class="text-danger"></span>
    </div>

    <!-- Description -->
    <div class="mb-3">
        <label asp-for="Movie.Description" class="form-label">Description</label>
        <textarea asp-for="Movie.Description" class="form-control" rows="5" placeholder="Enter Description"></textarea>
        <span asp-validation-for="Movie.Description" class="text-danger"></span>
    </div>

    <button type="submit" class="btn btn-primary px-4">
        <i class="fas fa-save me-2"></i>Save
    </button>
    <a asp-action="Index" class="btn btn-secondary px-4 ms-2">
        <i class="fas fa-times me-2"></i>Cancel
    </a>
</form>

@section Scripts
{
    <partial name="_ValidationScriptsPartial" />
    
}

<script>
    function previewMainImage(event) {
        const input = event.target;
        const preview = document.getElementById('mainPreview');
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = function(e) {
                preview.src = e.target.result;
            }
            reader.readAsDataURL(input.files[0]);
        }
    }

    function previewSubImages(event) {
        const input = event.target;
        const previewContainer = document.getElementById('subPreview');
        previewContainer.innerHTML = '';
        if (input.files) {
            Array.from(input.files).forEach(file => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.style.maxWidth = "100px";
                    img.style.border = "1px solid #ccc";
                    img.style.borderRadius = "5px";
                    img.style.padding = "2px";
                    previewContainer.appendChild(img);
                }
                reader.readAsDataURL(file);
            });
        }
    }
</script>